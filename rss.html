<!doctype html>
<html lang="pt-BR" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RSS Feed OBS - Editor e Visualizador</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    * {
      font-family: 'Inter', sans-serif;
    }
    
    .slide-enter {
      animation: slideIn 0.6s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(100px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .fade-transition {
      transition: opacity 0.3s ease-in-out;
    }
  </style>
  
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
  <div id="app-container" class="h-full w-full flex flex-col"><!-- Navigation -->
   <nav class="bg-slate-800/50 backdrop-blur-lg border-b border-purple-500/20">
    <div class="max-w-7xl mx-auto px-6 py-4">
     <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
       <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center"><span class="text-2xl">üì°</span>
       </div>
       <h1 class="text-2xl font-bold text-white">RSS Feed OBS</h1>
      </div>
      <div class="flex space-x-3"><button id="btn-editor" class="px-6 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition-colors"> ‚úèÔ∏è Editor </button> <button id="btn-viewer" class="px-6 py-2 bg-slate-700 text-white rounded-lg font-medium hover:bg-slate-600 transition-colors"> üì∫ Visualizar </button>
      </div>
     </div>
    </div>
   </nav><!-- Editor View -->
   <div id="editor-view" class="flex-1 overflow-auto">
    <div class="max-w-6xl mx-auto px-6 py-8"><!-- GitHub Configuration Alert -->
     <div id="config-alert" class="bg-yellow-900/30 backdrop-blur-lg rounded-2xl p-6 mb-8 border border-yellow-500/30">
      <h3 class="text-xl font-bold text-yellow-300 mb-4">‚öôÔ∏è Configura√ß√£o Necess√°ria</h3>
      <p class="text-yellow-200 mb-4">Para usar o sistema com GitHub, voc√™ precisa configurar suas credenciais. Edite o c√≥digo e substitua:</p>
      <ol class="text-yellow-100 space-y-2 mb-4">
       <li><strong>1.</strong> Seu usu√°rio do GitHub</li>
       <li><strong>2.</strong> Nome do reposit√≥rio</li>
       <li><strong>3.</strong> Token de acesso do GitHub</li>
      </ol>
      <div class="bg-slate-900/50 p-4 rounded-lg mb-4">
       <p class="text-sm text-purple-300 font-bold mb-2">Como criar um token:</p>
       <ol class="text-sm text-slate-300 space-y-1">
        <li>1. Acesse: <a href="https://github.com/settings/tokens" target="_blank" class="text-blue-400 underline">github.com/settings/tokens</a></li>
        <li>2. Clique em "Generate new token (classic)"</li>
        <li>3. D√™ um nome (ex: "OBS RSS Feed")</li>
        <li>4. Marque apenas: <strong>"repo"</strong> ou <strong>"public_repo"</strong></li>
        <li>5. Clique em "Generate token"</li>
        <li>6. Copie o token e cole no c√≥digo</li>
       </ol>
      </div><button id="btn-hide-alert" class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors"> Entendi, ocultar aviso </button>
     </div><!-- Add New Slide Card -->
     <div class="bg-slate-800/50 backdrop-blur-lg rounded-2xl p-6 mb-8 border border-purple-500/20">
      <h2 class="text-xl font-bold text-white mb-6">‚ûï Adicionar Novo Slide</h2>
      <form id="add-slide-form" class="space-y-5">
       <div><label for="slide-title" class="block text-sm font-medium text-purple-300 mb-2">T√≠tulo</label> <input type="text" id="slide-title" required class="w-full px-4 py-3 bg-slate-900/50 border border-purple-500/30 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors" placeholder="Ex: Novidades da Live">
       </div>
       <div><label for="slide-description" class="block text-sm font-medium text-purple-300 mb-2">Descri√ß√£o</label> <textarea id="slide-description" required rows="3" class="w-full px-4 py-3 bg-slate-900/50 border border-purple-500/30 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors resize-none" placeholder="Descreva o conte√∫do do slide..."></textarea>
       </div>
       <div><label for="slide-image" class="block text-sm font-medium text-purple-300 mb-2">URL da Imagem</label> <input type="url" id="slide-image" required class="w-full px-4 py-3 bg-slate-900/50 border border-purple-500/30 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 transition-colors" placeholder="https://exemplo.com/imagem.jpg">
        <p class="mt-2 text-sm text-slate-400">üí° Use URLs p√∫blicas de imagens (ex: Imgur, Dropbox, Google Drive com link p√∫blico)</p>
       </div><button type="submit" id="btn-add-slide" class="w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-all transform hover:scale-105"> Adicionar Slide </button>
      </form>
     </div><!-- Slides List -->
     <div class="bg-slate-800/50 backdrop-blur-lg rounded-2xl p-6 border border-purple-500/20">
      <div class="flex items-center justify-between mb-6">
       <h2 class="text-xl font-bold text-white">üìã Slides Criados</h2>
       <div class="flex gap-3 items-center"><button id="btn-refresh" class="px-4 py-2 bg-blue-600/20 text-blue-400 rounded-lg text-sm font-medium hover:bg-blue-600/30 transition-colors"> üîÑ Atualizar </button> <span id="slide-count" class="px-4 py-2 bg-purple-600/20 text-purple-300 rounded-lg font-medium">0 slides</span>
       </div>
      </div>
      <div id="slides-list" class="space-y-4"><!-- Slides will be inserted here -->
      </div>
      <div id="empty-state" class="text-center py-12">
       <div class="text-6xl mb-4">
        üì≠
       </div>
       <p class="text-slate-400 text-lg">Nenhum slide criado ainda</p>
       <p class="text-slate-500 mt-2">Adicione seu primeiro slide acima!</p>
      </div>
     </div><!-- Export/Import Data -->
     <div class="mt-8 bg-slate-800/50 backdrop-blur-lg rounded-2xl p-6 border border-purple-500/20">
      <h3 class="text-lg font-bold text-white mb-4">üíæ Backup e Restaura√ß√£o</h3>
      <div class="flex gap-4"><button id="btn-export" class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors"> üì• Exportar Dados (JSON) </button> <button id="btn-import" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors"> üì§ Importar Dados (JSON) </button>
      </div><input type="file" id="file-import" accept=".json" class="hidden">
     </div><!-- Instructions -->
     <div class="mt-8 bg-gradient-to-r from-purple-900/30 to-pink-900/30 backdrop-blur-lg rounded-2xl p-6 border border-purple-500/20">
      <h3 class="text-lg font-bold text-white mb-4">üìñ Como Usar no OBS</h3><!-- URL for OBS -->
      <div class="mb-6 p-4 bg-green-900/20 border-2 border-green-500/50 rounded-lg">
       <p class="text-green-300 font-bold mb-2">üéØ URL PARA USAR NO OBS (e em qualquer dispositivo!):</p>
       <div class="flex gap-2"><input type="text" id="obs-url" readonly class="flex-1 px-4 py-2 bg-slate-900/50 border border-green-500/30 rounded-lg text-green-400 font-mono text-sm select-all" value=""> <button id="btn-copy-url" class="px-6 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors whitespace-nowrap"> üìã Copiar </button>
       </div>
       <p class="text-green-200 text-xs mt-2">‚úÖ Esta URL funciona em qualquer dispositivo! Todos ver√£o os mesmos slides sincronizados pelo GitHub.</p>
      </div>
      <ol class="space-y-3 text-slate-300">
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">1.</span> <span>Configure o GitHub no c√≥digo (veja instru√ß√µes no aviso amarelo acima)</span></li>
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">2.</span> <span>Adicione seus slides usando o formul√°rio</span></li>
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">3.</span> <span><strong>Copie a URL verde acima</strong> - ela funciona em qualquer lugar!</span></li>
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">4.</span> <span>No OBS, adicione uma fonte "Navegador" e cole a URL</span></li>
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">5.</span> <span>Configure: Largura 1080px, Altura 1920px</span></li>
       <li class="flex items-start"><span class="font-bold text-purple-400 mr-3">6.</span> <span>Os slides sincronizam automaticamente via GitHub! üéâ</span></li>
      </ol>
      <div class="mt-4 p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg">
       <p class="text-blue-300 text-sm"><strong>üåê Vantagem:</strong> Agora voc√™ pode editar os slides do celular, tablet ou qualquer computador. O OBS sempre mostra a vers√£o mais atualizada!</p>
      </div>
     </div>
    </div>
   </div><!-- Viewer (Carousel) View -->
   <div id="viewer-view" class="hidden flex-1 bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative overflow-hidden">
    <div class="absolute inset-0 flex items-center justify-center">
     <div id="carousel-container" class="w-full h-full relative">
      <div id="carousel-slide" class="w-full h-full flex items-center justify-center p-8"><!-- Slide content will be inserted here -->
      </div><!-- Slide Indicator -->
      <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex space-x-2" id="slide-indicators"><!-- Indicators will be inserted here -->
      </div>
     </div>
     <div id="viewer-empty-state" class="text-center">
      <div class="text-8xl mb-6">
       üì∫
      </div>
      <p class="text-white text-3xl font-bold mb-4">Nenhum slide para exibir</p>
      <p class="text-purple-300 text-xl">Adicione slides no Editor primeiro</p>
     </div>
    </div>
   </div>
  </div>
  <script>
    // GitHub-based storage configuration
    // ‚ö†Ô∏è IMPORTANTE: Substitua com suas informa√ß√µes do GitHub
    const GITHUB_CONFIG = {
      owner: 'carloscoelhogti',        // Seu usu√°rio do GitHub
      repo: 'in',            // Nome do seu reposit√≥rio
      token: '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'             // Token do GitHub (veja instru√ß√µes abaixo)
    };
    
    // Para criar um token:
    // 1. V√° em: https://github.com/settings/tokens
    // 2. Clique em "Generate new token (classic)"
    // 3. D√™ um nome (ex: "OBS RSS Feed")
    // 4. Marque apenas: "repo" (ou "public_repo" se for reposit√≥rio p√∫blico)
    // 5. Clique em "Generate token" e copie o token
    // 6. Cole o token acima
    
    let currentRecords = [];
    let currentView = 'editor';
    let currentSlideIndex = 0;
    let carouselInterval = null;
    let storageCheckInterval = null;
    let isConfigured = false;
    
    // Check if GitHub is configured
    function checkConfiguration() {
      isConfigured = GITHUB_CONFIG.owner !== 'SEU-USUARIO-GITHUB' && 
                     GITHUB_CONFIG.repo !== 'SEU-REPOSITORIO' && 
                     GITHUB_CONFIG.token !== 'SEU-TOKEN-AQUI';
      
      if (isConfigured) {
        const alert = document.getElementById('config-alert');
        if (alert) alert.style.display = 'none';
      }
      
      return isConfigured;
    }
    
    // Load data from GitHub (using a JSON file in the repo)
    async function loadData() {
      if (!checkConfiguration()) {
        console.warn('GitHub n√£o configurado');
        currentRecords = [];
        renderSlidesList();
        return;
      }
      
      try {
        const response = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/slides-data.json`,
          {
            headers: {
              'Authorization': `token ${GITHUB_CONFIG.token}`,
              'Accept': 'application/vnd.github.v3+json'
            }
          }
        );
        
        if (response.ok) {
          const data = await response.json();
          const content = atob(data.content);
          currentRecords = JSON.parse(content);
        } else if (response.status === 404) {
          // File doesn't exist yet, initialize empty
          currentRecords = [];
        } else {
          throw new Error('Erro ao carregar dados do GitHub');
        }
      } catch (e) {
        console.error('Erro ao carregar dados:', e);
        showToast('Erro ao carregar dados do GitHub. Verifique suas credenciais.', 'error');
        currentRecords = [];
      }
      renderSlidesList();
    }
    
    // Save data to GitHub
    async function saveData() {
      if (!checkConfiguration()) {
        showToast('Configure o GitHub primeiro! Veja instru√ß√µes no c√≥digo.', 'error');
        return;
      }
      
      const btnAdd = document.getElementById('btn-add-slide');
      btnAdd.disabled = true;
      btnAdd.textContent = 'Salvando no GitHub...';
      
      try {
        // First, try to get the current file SHA (needed for updates)
        let sha = null;
        const getResponse = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/slides-data.json`,
          {
            headers: {
              'Authorization': `token ${GITHUB_CONFIG.token}`,
              'Accept': 'application/vnd.github.v3+json'
            }
          }
        );
        
        if (getResponse.ok) {
          const getData = await getResponse.json();
          sha = getData.sha;
        }
        
        // Now save the data
        const content = btoa(unescape(encodeURIComponent(JSON.stringify(currentRecords, null, 2))));
        const response = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/slides-data.json`,
          {
            method: 'PUT',
            headers: {
              'Authorization': `token ${GITHUB_CONFIG.token}`,
              'Accept': 'application/vnd.github.v3+json',
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              message: 'Atualizar slides do RSS Feed',
              content: content,
              sha: sha
            })
          }
        );
        
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.message || 'Erro ao salvar dados');
        }
        
        renderSlidesList();
        showToast('Dados salvos no GitHub! ‚úÖ', 'success');
      } catch (e) {
        console.error('Erro ao salvar dados:', e);
        showToast('Erro ao salvar! Verifique suas credenciais do GitHub.', 'error');
      } finally {
        btnAdd.disabled = false;
        btnAdd.textContent = 'Adicionar Slide';
      }
    }
    
    // Poll for data changes (for real-time updates across devices)
    function startStoragePolling() {
      if (currentView === 'viewer' && checkConfiguration()) {
        storageCheckInterval = setInterval(async () => {
          await loadData();
          if (currentRecords.length > 0 && currentView === 'viewer') {
            renderCarousel();
          }
        }, 10000); // Check every 10 seconds
      }
    }
    
    function stopStoragePolling() {
      if (storageCheckInterval) {
        clearInterval(storageCheckInterval);
        storageCheckInterval = null;
      }
    }
    
    // Update OBS URL display
    function updateOBSUrl() {
      const currentUrl = window.location.href.split('?')[0];
      const obsUrl = currentUrl + '?view=viewer';
      const urlInput = document.getElementById('obs-url');
      if (urlInput) {
        urlInput.value = obsUrl;
      }
    }
    
    // Check URL parameters to auto-switch to viewer mode
    function checkURLParams() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('view') === 'viewer') {
        // Hide navigation for clean OBS display
        document.querySelector('nav').style.display = 'none';
        switchView('viewer');
      }
    }
    
    // Initialize app
    async function initApp() {
      updateOBSUrl();
      checkURLParams();
      await loadData();
      setupEventListeners();
    }
    
    function setupEventListeners() {
      document.getElementById('btn-editor').addEventListener('click', () => switchView('editor'));
      document.getElementById('btn-viewer').addEventListener('click', () => switchView('viewer'));
      
      document.getElementById('btn-hide-alert').addEventListener('click', () => {
        document.getElementById('config-alert').style.display = 'none';
      });
      
      document.getElementById('btn-refresh').addEventListener('click', async () => {
        const btn = document.getElementById('btn-refresh');
        btn.textContent = '‚è≥ Carregando...';
        btn.disabled = true;
        await loadData();
        btn.textContent = 'üîÑ Atualizar';
        btn.disabled = false;
        showToast('Dados atualizados!', 'success');
      });
      
      document.getElementById('add-slide-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (currentRecords.length >= 999) {
          showToast('Limite m√°ximo de 999 slides atingido!', 'error');
          return;
        }
        
        const title = document.getElementById('slide-title').value;
        const description = document.getElementById('slide-description').value;
        const imageUrl = document.getElementById('slide-image').value;
        
        const newSlide = {
          id: Date.now().toString(),
          title,
          description,
          image_url: imageUrl,
          order: currentRecords.length,
          created_at: new Date().toISOString()
        };
        
        currentRecords.push(newSlide);
        await saveData();
        
        document.getElementById('add-slide-form').reset();
      });
      
      // Export functionality
      document.getElementById('btn-export').addEventListener('click', () => {
        const dataStr = JSON.stringify(currentRecords, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `rss-feed-backup-${Date.now()}.json`;
        link.click();
        URL.revokeObjectURL(url);
        showToast('Dados exportados com sucesso!', 'success');
      });
      
      // Import functionality
      document.getElementById('btn-import').addEventListener('click', () => {
        document.getElementById('file-import').click();
      });
      
      document.getElementById('file-import').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = async (event) => {
          try {
            const imported = JSON.parse(event.target.result);
            if (Array.isArray(imported)) {
              currentRecords = imported;
              await saveData();
              showToast('Dados importados com sucesso!', 'success');
            } else {
              showToast('Arquivo JSON inv√°lido!', 'error');
            }
          } catch (error) {
            showToast('Erro ao ler arquivo!', 'error');
          }
        };
        reader.readAsText(file);
        e.target.value = '';
      });
      
      // Copy OBS URL to clipboard
      document.getElementById('btn-copy-url').addEventListener('click', () => {
        const urlInput = document.getElementById('obs-url');
        urlInput.select();
        urlInput.setSelectionRange(0, 99999);
        
        navigator.clipboard.writeText(urlInput.value).then(() => {
          showToast('URL copiada! Cole no OBS ou compartilhe üìã', 'success');
        }).catch(() => {
          // Fallback for older browsers
          document.execCommand('copy');
          showToast('URL copiada para √°rea de transfer√™ncia!', 'success');
        });
      });
    }
    
    function renderSlidesList() {
      const container = document.getElementById('slides-list');
      const emptyState = document.getElementById('empty-state');
      const countElement = document.getElementById('slide-count');
      
      countElement.textContent = `${currentRecords.length} ${currentRecords.length === 1 ? 'slide' : 'slides'}`;
      
      if (currentRecords.length === 0) {
        container.classList.add('hidden');
        emptyState.classList.remove('hidden');
        return;
      }
      
      container.classList.remove('hidden');
      emptyState.classList.add('hidden');
      
      container.innerHTML = currentRecords.map((slide, index) => `
        <div class="bg-slate-900/50 rounded-xl p-5 border border-purple-500/20 hover:border-purple-500/40 transition-colors">
          <div class="flex gap-5">
            <img src="${slide.image_url}" 
              alt="${slide.title}"
              class="w-32 h-32 object-cover rounded-lg border-2 border-purple-500/30"
              onerror="this.src=''; this.alt='Imagem n√£o carregou'; this.style.display='none';">
            <div class="flex-1 min-w-0">
              <h3 class="text-lg font-bold text-white mb-2">${slide.title}</h3>
              <p class="text-slate-400 text-sm mb-4 line-clamp-2">${slide.description}</p>
              <div class="flex items-center justify-between">
                <span class="text-xs text-purple-400">Ordem: ${index + 1}</span>
                <button onclick="deleteSlide(${index})" 
                  class="px-4 py-2 bg-red-600/20 text-red-400 rounded-lg text-sm font-medium hover:bg-red-600/30 transition-colors">
                  üóëÔ∏è Deletar
                </button>
              </div>
            </div>
          </div>
        </div>
      `).join('');
    }
    
    async function deleteSlide(index) {
      currentRecords.splice(index, 1);
      await saveData();
      showToast('Slide deletado com sucesso!', 'success');
    }
    
    function switchView(view) {
      currentView = view;
      
      const editorView = document.getElementById('editor-view');
      const viewerView = document.getElementById('viewer-view');
      const btnEditor = document.getElementById('btn-editor');
      const btnViewer = document.getElementById('btn-viewer');
      
      if (view === 'editor') {
        editorView.classList.remove('hidden');
        viewerView.classList.add('hidden');
        btnEditor.classList.remove('bg-slate-700');
        btnEditor.classList.add('bg-purple-600');
        btnViewer.classList.remove('bg-purple-600');
        btnViewer.classList.add('bg-slate-700');
        stopCarousel();
        stopStoragePolling();
      } else {
        editorView.classList.add('hidden');
        viewerView.classList.remove('hidden');
        btnEditor.classList.remove('bg-purple-600');
        btnEditor.classList.add('bg-slate-700');
        btnViewer.classList.remove('bg-slate-700');
        btnViewer.classList.add('bg-purple-600');
        currentSlideIndex = 0;
        renderCarousel();
        startCarousel();
        startStoragePolling(); // Start polling for updates
      }
    }
    
    function renderCarousel() {
      const container = document.getElementById('carousel-slide');
      const emptyState = document.getElementById('viewer-empty-state');
      const indicatorsContainer = document.getElementById('slide-indicators');
      
      if (currentRecords.length === 0) {
        container.classList.add('hidden');
        emptyState.classList.remove('hidden');
        indicatorsContainer.innerHTML = '';
        return;
      }
      
      container.classList.remove('hidden');
      emptyState.classList.add('hidden');
      
      const slide = currentRecords[currentSlideIndex];
      
      container.innerHTML = `
        <div class="w-full max-w-2xl mx-auto slide-enter">
          <div class="bg-gradient-to-br from-slate-800/80 to-purple-900/80 backdrop-blur-xl rounded-3xl p-8 border-2 border-purple-500/30 shadow-2xl">
            <img src="${slide.image_url}" 
              alt="${slide.title}"
              class="w-full h-96 object-cover rounded-2xl mb-6 border-2 border-purple-500/50"
              onerror="this.src=''; this.alt='Imagem n√£o dispon√≠vel'; this.classList.add('hidden');">
            <h2 class="text-4xl font-bold text-white mb-4">${slide.title}</h2>
            <p class="text-xl text-purple-200 leading-relaxed">${slide.description}</p>
          </div>
        </div>
      `;
      
      indicatorsContainer.innerHTML = currentRecords.map((_, index) => `
        <div class="w-3 h-3 rounded-full transition-all ${
          index === currentSlideIndex 
            ? 'bg-purple-500 w-8' 
            : 'bg-purple-500/30'
        }"></div>
      `).join('');
    }
    
    function startCarousel() {
      stopCarousel();
      if (currentRecords.length <= 1) return;
      
      carouselInterval = setInterval(() => {
        currentSlideIndex = (currentSlideIndex + 1) % currentRecords.length;
        renderCarousel();
      }, 20000);
    }
    
    function stopCarousel() {
      if (carouselInterval) {
        clearInterval(carouselInterval);
        carouselInterval = null;
      }
    }
    
    function showToast(message, type) {
      const toast = document.createElement('div');
      toast.className = `fixed top-24 right-6 px-6 py-4 rounded-lg shadow-lg text-white font-medium z-50 ${
        type === 'success' ? 'bg-green-600' : 'bg-red-600'
      }`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    
    window.deleteSlide = deleteSlide;
    
    // Start app
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bdf47c9a185df52',t:'MTc2ODQxNjIyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>